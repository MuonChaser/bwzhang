<!doctype html><html lang=zh-hans><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lxgw-wenkai-screen-web/style.css fetchpriority=low><style>body{font-family:lxgw wenkai screen;font-weight:400}</style><title>共轭先验 | 博客于文</title><meta property="og:title" content="共轭先验 - 博客于文"><meta property="og:type" content="article"><meta property="article:published_time" content='2025-11-28T00:00:00+08:00'><meta property="article:modified_time" content='2025-11-28T00:00:00+08:00'><meta name=Keywords content><meta name=description content="共轭先验"><meta name=author content="Bowen Zhang"><meta property="og:url" content="http://blog.bwzhang.cn/posts/math/%E8%B4%9D%E5%8F%B6%E6%96%AF-%E5%85%B1%E8%BD%AD%E5%85%88%E9%AA%8C/"><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=icon href=/favicon.png type=image/png><link rel="alternate icon" href=/favicon.png type=image/svg+xml><link rel=stylesheet href=/css/normalize.css fetchpriority=low><link rel=stylesheet href=/css/style.css fetchpriority=low><script src=https://code.jquery.com/jquery-3.7.1.slim.min.js integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8=" crossorigin=anonymous fetchpriority=low></script><link rel=stylesheet href=/css/style.css fetchpriority=low><script>(function(){const e=1e3,t=document.createElement;document.createElement=function(n){const s=t.call(document,n),o=n.toLowerCase();if(["script","link","img"].includes(o)){const t=setTimeout(()=>{if(s.parentNode){s.parentNode.removeChild(s);const e=s.src||s.href;console.warn(`Resource loading timeout (${o}): ${e}`)}},e);s.addEventListener("load",()=>clearTimeout(t)),s.addEventListener("error",()=>clearTimeout(t))}return s}})()</script></head><body data-auto-sidebar-collapse=false><header id=header class=clearfix><div class=container><div class=col-group><div class=site-name><a id=logo href=http://blog.bwzhang.cn/>博客于文</a><p class=description>博学于文，约之以礼</p></div><div><nav id=nav-menu class=clearfix><a class=current href=http://blog.bwzhang.cn/>首页</a>
<button id=sidebar-toggle class=sidebar-toggle aria-controls=secondary aria-expanded=true title=隐藏/展开侧边栏>隐藏侧边栏</button></nav></div></div></div></header><div id=body><div class=container><div class=col-group><div class=col-8 id=main><div class=res-cons><article class=post><header><h1 class=post-title>共轭先验</h1></header><time datetime=2025-11-28T00:00:00Z class="post-meta meta-date dt-published">2025年11月28日</time><div class="post-meta meta-category"><span>&nbsp;|</span>
<a href=/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0 target=_blank>学习笔记</a></div><div class=post-content><p>共轭先验（conjugate prior）是贝叶斯统计中的一个重要概念，使得后验分布与先验分布具有相同的函数形式，大大简化了贝叶斯推断的计算。</p><h2 id=1-共轭先验的定义>1. 共轭先验的定义</h2><h3 id=11-基本定义>1.1 基本定义</h3><p>设似然函数为 $L(\theta | x) = p(x | \theta)$，先验分布为 $\pi(\theta)$。</p><p><strong>定义</strong>：如果先验分布 $\pi(\theta)$ 与后验分布 $\pi(\theta | x)$ 属于同一分布族，则称 $\pi(\theta)$ 是似然函数的<strong>共轭先验</strong>。</p><h3 id=12-数学表述>1.2 数学表述</h3><p>根据贝叶斯定理，后验分布为：</p><p>$$\pi(\theta | x) = \frac{p(x|\theta) \pi(\theta)}{\int p(x|\theta) \pi(\theta) d\theta} \propto p(x|\theta) \pi(\theta)$$</p><p>若 $\pi(\theta) \in \mathcal{F}$（某个分布族），且 $\pi(\theta|x) \in \mathcal{F}$，则 $\mathcal{F}$ 对应的分布是似然函数 $p(x|\theta)$ 的共轭先验族。</p><h3 id=13-共轭先验的优点>1.3 共轭先验的优点</h3><ul><li><strong>计算便利</strong>：避免复杂的数值积分，有闭形式解</li><li><strong>参数更新</strong>：先验参数和观测数据可通过简单规则组合更新</li><li><strong>直观理解</strong>：超参数具有明确的概率解释</li><li><strong>递推贝叶斯</strong>：新的后验可作为下一次观测的先验</li></ul><h2 id=2-常见共轭分布对>2. 常见共轭分布对</h2><h3 id=21-正态-正态共轭gaussian-gaussian-conjugacy>2.1 正态-正态共轭（Gaussian-Gaussian Conjugacy）</h3><p><strong>似然</strong>：$X | \mu \sim N(\mu, \sigma_0^2)$，$\sigma_0^2$ 已知</p><p><strong>先验</strong>：$\mu \sim N(\mu_0, \tau_0^2)$</p><p><strong>后验</strong>：$\mu | X \sim N(\mu_n, \tau_n^2)$</p><p><strong>参数更新规则</strong>：</p><p>对单个观测 $x$：
$$\mu_n = \frac{\tau_0^{-2} \mu_0 + \sigma_0^{-2} x}{\tau_0^{-2} + \sigma_0^{-2}}$$</p><p>$$\tau_n^{-2} = \tau_0^{-2} + \sigma_0^{-2}$$</p><p>对 $n$ 个独立观测 $x_1, \ldots, x_n$，$\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i$：
$$\mu_n = \frac{\tau_0^{-2} \mu_0 + n\sigma_0^{-2} \bar{x}}{\tau_0^{-2} + n\sigma_0^{-2}}$$</p><p>$$\tau_n^{-2} = \tau_0^{-2} + n\sigma_0^{-2}$$</p><p><strong>直观解释</strong>：后验均值是先验和数据均值的加权平均，权重与各自的精度（倒数方差）成正比。</p><h3 id=22-beta-二项共轭beta-binomial-conjugacy>2.2 Beta-二项共轭（Beta-Binomial Conjugacy）</h3><p><strong>似然</strong>：$X | p \sim \text{Binomial}(n, p)$</p><p><strong>先验</strong>：$p \sim \text{Beta}(\alpha, \beta)$</p><p><strong>后验</strong>：$p | X \sim \text{Beta}(\alpha + x, \beta + n - x)$</p><p><strong>参数更新规则</strong>：</p><p>若观测到 $x$ 次成功（共 $n$ 次试验）：
$$\alpha_{new} = \alpha + x$$
$$\beta_{new} = \beta + (n - x)$$</p><p><strong>直观解释</strong>：</p><ul><li>$\alpha$ 可理解为先验中"成功"的伪计数</li><li>$\beta$ 可理解为先验中"失败"的伪计数</li><li>后验参数直接加上观测的成功和失败次数</li></ul><p><strong>特殊情况</strong>：</p><ul><li>无信息先验：$\alpha = \beta = 1$（均匀分布）</li><li>Jeffreys 先验：$\alpha = \beta = 0.5$</li></ul><h3 id=23-gamma-poisson-共轭gamma-poisson-conjugacy>2.3 Gamma-Poisson 共轭（Gamma-Poisson Conjugacy）</h3><p><strong>似然</strong>：$X | \lambda \sim \text{Poisson}(\lambda)$</p><p><strong>先验</strong>：$\lambda \sim \text{Gamma}(\alpha, \beta)$</p><p><strong>后验</strong>：$\lambda | X \sim \text{Gamma}(\alpha + x, \beta + 1)$</p><p><strong>参数更新规则</strong>（单个观测）：
$$\alpha_{new} = \alpha + x$$
$$\beta_{new} = \beta + 1$$</p><p>对 $n$ 个独立观测 $x_1, \ldots, x_n$：
$$\alpha_{new} = \alpha + \sum_{i=1}^n x_i$$
$$\beta_{new} = \beta + n$$</p><p><strong>直观解释</strong>：</p><ul><li>$\alpha$ 为形状参数，可理解为先验观测的总事件数</li><li>$\beta$ 为速率参数，可理解为先验观测的周期数</li><li>后验参数加上观测的事件总数和周期数</li></ul><h3 id=24-gamma-指数共轭gamma-exponential-conjugacy>2.4 Gamma-指数共轭（Gamma-Exponential Conjugacy）</h3><p><strong>似然</strong>：$X | \lambda \sim \text{Exp}(\lambda)$，密度为 $f(x|\lambda) = \lambda e^{-\lambda x}$</p><p><strong>先验</strong>：$\lambda \sim \text{Gamma}(\alpha, \beta)$</p><p><strong>后验</strong>：$\lambda | x_1, \ldots, x_n \sim \text{Gamma}\left(\alpha + n, \beta + \sum_{i=1}^n x_i\right)$</p><p><strong>参数更新规则</strong>：
$$\alpha_{new} = \alpha + n$$
$$\beta_{new} = \beta + \sum_{i=1}^n x_i$$</p><h3 id=25-dirichlet-多项共轭dirichlet-multinomial-conjugacy>2.5 Dirichlet-多项共轭（Dirichlet-Multinomial Conjugacy）</h3><p><strong>似然</strong>：$\mathbf{X} | \mathbf{p} \sim \text{Multinomial}(n, \mathbf{p})$</p><p>其中 $\mathbf{p} = (p_1, \ldots, p_k)$，$\sum_{j=1}^k p_j = 1$</p><p><strong>先验</strong>：$\mathbf{p} \sim \text{Dirichlet}(\alpha_1, \ldots, \alpha_k)$</p><p><strong>后验</strong>：$\mathbf{p} | \mathbf{X} \sim \text{Dirichlet}(\alpha_1 + n_1, \ldots, \alpha_k + n_k)$</p><p>其中 $n_j$ 为第 $j$ 类的观测计数。</p><p><strong>参数更新规则</strong>：
$$\alpha_{j,new} = \alpha_j + n_j, \quad j = 1, \ldots, k$$</p><p><strong>特殊情况</strong>：</p><ul><li>对称 Dirichlet 先验：$\alpha_1 = \cdots = \alpha_k = \alpha$</li><li>无信息先验：$\alpha = 1$（均匀 Dirichlet）</li></ul><h3 id=26-正态-正态共轭方差未知>2.6 正态-正态共轭（方差未知）</h3><p><strong>似然</strong>：$X | \mu, \sigma^2 \sim N(\mu, \sigma^2)$</p><p><strong>先验</strong>：</p><ul><li>$\mu | \sigma^2 \sim N(\mu_0, \sigma^2/\kappa_0)$</li><li>$\sigma^2 \sim \text{Inv-Gamma}(\nu_0/2, \nu_0\sigma_0^2/2)$</li></ul><p><strong>后验</strong>：</p><ul><li>$\mu | \sigma^2, \mathbf{x} \sim N(\mu_n, \sigma^2/\kappa_n)$</li><li>$\sigma^2 | \mathbf{x} \sim \text{Inv-Gamma}(\nu_n/2, \nu_n\sigma_n^2/2)$</li></ul><p><strong>参数更新规则</strong>（$n$ 个观测，$\bar{x}$ 为样本均值，$s^2 = \sum_{i=1}^n (x_i - \bar{x})^2$）：</p><p>$$\kappa_n = \kappa_0 + n$$</p><p>$$\mu_n = \frac{\kappa_0 \mu_0 + n\bar{x}}{\kappa_0 + n}$$</p><p>$$\nu_n = \nu_0 + n$$</p><p>$$\sigma_n^2 = \frac{\nu_0\sigma_0^2 + (n-1)s^2 + \frac{\kappa_0 n}{kappa_0 + n}(\bar{x} - \mu_0)^2}{\nu_0 + n}$$</p><h2 id=3-共轭先验总结表>3. 共轭先验总结表</h2><table><thead><tr><th>似然函数</th><th>共轭先验族</th><th>后验分布</th><th>先验参数</th></tr></thead><tbody><tr><td>$\text{Binomial}(n, p)$</td><td>Beta</td><td>Beta</td><td>$\alpha, \beta$</td></tr><tr><td>$\text{Poisson}(\lambda)$</td><td>Gamma</td><td>Gamma</td><td>$\alpha, \beta$</td></tr><tr><td>$\text{Exp}(\lambda)$</td><td>Gamma</td><td>Gamma</td><td>$\alpha, \beta$</td></tr><tr><td>$\text{Geometric}(p)$</td><td>Beta</td><td>Beta</td><td>$\alpha, \beta$</td></tr><tr><td>$\text{Uniform}(0, \theta)$</td><td>Pareto</td><td>Pareto</td><td>$\alpha, x_0$</td></tr><tr><td>$N(\mu, \sigma_0^2)$</td><td>Normal</td><td>Normal</td><td>$\mu_0, \tau_0^2$</td></tr><tr><td>$\text{Multinomial}(n, \mathbf{p})$</td><td>Dirichlet</td><td>Dirichlet</td><td>$\boldsymbol{\alpha}$</td></tr></tbody></table><h2 id=4-贝叶斯更新的递推性质>4. 贝叶斯更新的递推性质</h2><p>共轭先验的一个重要性质是**递推贝叶斯（sequential Bayes）**的便利性：</p><p>$$\text{后验}<em>n = \text{先验}</em>{n+1}$$</p><p>即，第 $n$ 次观测后的后验分布可作为第 $n+1$ 次观测的先验分布。</p><p><strong>例子</strong>（Beta-Binomial）：</p><ul><li>初始先验：$p \sim \text{Beta}(2, 2)$</li><li>观测 1 次成功，1 次失败：后验 $\sim \text{Beta}(3, 3)$</li><li>新观测 2 次成功，0 次失败：新后验 $\sim \text{Beta}(5, 3)$</li></ul><h2 id=5-超参数的先验解释>5. 超参数的先验解释</h2><p>对于许多共轭先验，其参数具有明确的概率解释：</p><h3 id=51-beta-分布>5.1 Beta 分布</h3><ul><li>$\alpha - 1$：先验中"成功"的伪计数</li><li>$\beta - 1$：先验中"失败"的伪计数</li><li>$\alpha + \beta - 2$：先验总伪计数</li></ul><h3 id=52-gamma-分布>5.2 Gamma 分布</h3><ul><li>$\alpha$：形状参数，对应伪观测的总值</li><li>$\beta$：速率参数，对应伪观测次数</li><li>先验中位数：$E[X] = \alpha/\beta$</li></ul><h3 id=53-dirichlet-分布>5.3 Dirichlet 分布</h3><ul><li>$\alpha_j - 1$：第 $j$ 类的伪计数</li><li>$\sum_j(\alpha_j - 1)$：总伪计数</li><li>$\text{Dir}(\mathbf{1})$（所有 $\alpha_j = 1$）为无信息先验</li></ul><h2 id=6-共轭先验与无信息先验>6. 共轭先验与无信息先验</h2><p>虽然共轭先验主要是为了计算便利，但某些共轭先验可作为无信息（或弱信息）先验：</p><table><thead><tr><th>分布</th><th>无信息/弱信息先验</th><th>说明</th></tr></thead><tbody><tr><td>Beta</td><td>$\text{Beta}(1, 1)$</td><td>均匀分布</td></tr><tr><td>Gamma</td><td>$\text{Gamma}(\epsilon, \epsilon)$，$\epsilon \to 0$</td><td>非正规化 Jeffreys 先验</td></tr><tr><td>Normal</td><td>$N(\mu_0, \tau_0^2)$，$\tau_0 \to \infty$</td><td>方差趋于无穷</td></tr><tr><td>Dirichlet</td><td>$\text{Dir}(\mathbf{1})$</td><td>对称无信息先验</td></tr></tbody></table><h2 id=7-参考文献>7. 参考文献</h2><ul><li>Gelman, A., et al. (2013). Bayesian Data Analysis (3rd ed.). Chapman and Hall/CRC.</li><li>Robert, C. P., & Casella, G. (2004). Monte Carlo Statistical Methods (2nd ed.). Springer.</li><li>Bernardo, J. M., & Smith, A. F. (2009). Bayesian Theory. Wiley.</li><li>Murphy, K. P. (2012). Machine Learning: A Probabilistic Perspective. MIT Press.</li></ul></div><div class=post-archive><h2>相关文章</h2><ul class=listing><li><a href=/posts/math/%E8%B4%9D%E5%8F%B6%E6%96%AF-%E5%B0%BA%E5%BA%A6%E4%B8%8E%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E6%97%8F/>尺度与位置参数</a></li><li><a href=/posts/math/kl/>KL散度与MLE、MAP</a></li></ul></div><div class="post-meta meta-tags"><ul class=clearfix><li><a href=/tags/%E6%A6%82%E7%8E%87%E8%AE%BA target=_blank>概率论</a></li><li><a href=/tags/%E8%B4%9D%E5%8F%B6%E6%96%AF target=_blank>贝叶斯</a></li></ul></div></article></div><footer id=footer><div>&copy; 2026 <a href=http://blog.bwzhang.cn/>博客于文 By Bowen Zhang</a></div><br><div></div></footer><script type=text/javascript>window.MathJax={tex2jax:{inlineMath:[["$","$"]],processEscapes:!0}}</script><script src='//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async fetchpriority=low></script><a id=rocket href=#top></a><script type=text/javascript src='/js/totop.js?v=0.0.0' async fetchpriority=low></script><style type=text/css>div.highlight{position:relative;margin:1em 0}.copy-code{display:none;position:absolute;top:4px;right:4px;color:rgba(255,255,255,.8);background:rgba(78,78,78,.8);border-radius:var(--radius);padding:0 5px;font:inherit;user-select:none;cursor:pointer;border:0;--radius:8px}div.highlight:hover .copy-code,pre:hover .copy-code{display:block}</style><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></div><div id=secondary><section class=widget><form id=search action=//www.google.com/search method=get accept-charset=utf-8 target=_blank _lpchecked=1><input type=text name=q maxlength=20 placeholder=Search>
<input type=hidden name=sitesearch value=http://blog.bwzhang.cn/>
<button type=submit class="submit icon-search"></button></form></section><section class=widget><h3 class=widget-title>最近文章</h3><ul class=widget-list><li><a href=http://blog.bwzhang.cn/posts/math/%E8%B4%9D%E5%8F%B6%E6%96%AF-%E5%85%B1%E8%BD%AD%E5%85%88%E9%AA%8C/ title=共轭先验 target=_blank>共轭先验</a></li><li><a href=http://blog.bwzhang.cn/posts/math/%E8%B4%9D%E5%8F%B6%E6%96%AF-%E5%B0%BA%E5%BA%A6%E4%B8%8E%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E6%97%8F/ title=尺度与位置参数 target=_blank>尺度与位置参数</a></li><li><a href=http://blog.bwzhang.cn/posts/math/%E7%9F%A9%E9%98%B5%E6%B1%82%E5%AF%BC/ title=对矩阵求导 target=_blank>对矩阵求导</a></li><li><a href=http://blog.bwzhang.cn/posts/finance/bond/ title=债券、国债与国债收益率曲线 target=_blank>债券、国债与国债收益率曲线</a></li><li><a href=http://blog.bwzhang.cn/posts/math/kl/ title=KL散度与MLE、MAP target=_blank>KL散度与MLE、MAP</a></li><li><a href=http://blog.bwzhang.cn/posts/math/inequity/ title=概率论中的常见不等式 target=_blank>概率论中的常见不等式</a></li></ul></section><section class=widget><h3 class=widget-title><a href=/categories/>分类</a></h3><ul class=widget-list><li><a href=http://blog.bwzhang.cn/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/>学习笔记 (5)</a></li><li><a href=http://blog.bwzhang.cn/categories/%E9%87%91%E8%9E%8D/>金融 (1)</a></li></ul></section><section class=widget><h3 class=widget-title><a href=/tags/>标签</a></h3><div class=tagcloud><a href=http://blog.bwzhang.cn/tags/%E5%80%BA%E5%88%B8/>债券</a>
<a href=http://blog.bwzhang.cn/tags/%E5%87%B8%E4%BC%98%E5%8C%96/>凸优化</a>
<a href=http://blog.bwzhang.cn/tags/%E6%A6%82%E7%8E%87%E8%AE%BA/>概率论</a>
<a href=http://blog.bwzhang.cn/tags/%E8%AE%A1%E9%87%8F%E7%BB%8F%E6%B5%8E%E5%AD%A6/>计量经济学</a>
<a href=http://blog.bwzhang.cn/tags/%E8%B4%9D%E5%8F%B6%E6%96%AF/>贝叶斯</a></div></section><section class=widget><h3 class=widget-title>其它</h3><ul class=widget-list><li><a href=http://blog.bwzhang.cn/index.xml>文章 RSS</a></li></ul></section></div></div></div></div></body></html>